#!/bin/sh

# Gives a dmenu prompt to search DuckDuckGo.
# Without input, will open DuckDuckGo.com.
# Anything else, it search it.

LAUNCER="dmenu"

if [ -f ~/.surf/bookmarks ]; then
	 choice=$( (echo "ðŸ¦†" && cat ~/.surf/bookmarks) | $LAUNCER -l 5 -i -p "Search:") || exit 1
else 
	choice=$(echo "ðŸ¦†" | $LAUNCER -i -p "Search DuckDuckGo:") || exit 1
fi

case "$choice" in 
  *ðŸ¦†*)
    $BROWSER  "https://duckduckgo.com" > ~/.surf/log 2>&1 && exit
    ;;
  http*)
    $BROWSER  "$choice" > ~/.surf/log 2>&1 && exit
    ;;
  *)
    if [ $TRUEBROWSER = "surf" ];then
	setsid surf -w "https://duckduckgo.com/?q=$choice"  > /tmp/sur &
	sleep 0.5
	winid=$(cat sur | head -n 1)
	xprop -id "$winid" -f "_SURF_SEARCH" 8s -set  "_SURF_SEARCH" "$choice"
	exit
    else 
	$BROWSER  "https://duckduckgo.com/?q=$choice" > ~/.surf/log 2>&1 && exit
    fi
    ;;
esac
