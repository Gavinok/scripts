#!/usr/bin/sh

# script they plays youtube videos that opens a youtube video in
# the best available quality up to 480p since more then that
# is bloat

notify-send "Playing video"
# try to run video in lower format
allcpus_enabled=$(cat /sys/devices/system/cpu/cpu1/online)
plugged_in=/sys/class/power_supply/AC

# if not all cpus re enabled enabled use 360p
if [ "$allcpus_enabled" -eq 0 ]; then
	setsid mpv --force-window=immediate --really-quiet --ytdl-format="bestvideo[height<=?360]+bestaudio/best" "$*" >/dev/null 2>&1 && exit
elif [ -d "$plugged_in" ]; then
	# default to 720p
	setsid mpv --force-window=immediate --really-quiet --ytdl-format="bestvideo[height<=?720]+bestaudio/best" "$*" >/dev/null 2>&1 && exit
else
	# default to 720p
	setsid mpv --force-window=immediate --really-quiet --ytdl-format="bestvideo[height<=?480]+bestaudio/best" "$*" >/dev/null 2>&1 && exit
fi

# video cannot me loaded
notify-send "Failed to play Video"
#vim:ft=sh
